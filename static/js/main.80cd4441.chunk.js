(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{33:function(e,t,a){e.exports=a(48)},47:function(e,t,a){},48:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(29),s=a.n(l);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=a(12),o=a(13),i=a(16),u=a(14),h=a(17),m=a(5),p=a(10),g=a(15),_=a(9),d=a(31),E=a(2),v={errors:null},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return Object(E.a)({},e,{errors:t.errors});default:return e}},f={page:1,itemsPerPage:10,amountOfPages:null,amountOfPaginationLinks:5},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_AMOUNT_OF_PAGES":return Object(E.a)({},e,{amountOfPages:t.pagesAmount});case"SET_CURRENT_PAGE":return Object(E.a)({},e,{page:t.page});case"SET_CURRENT_LIMIT":return Object(E.a)({},e,{itemsPerPage:t.limit});default:return e}},y={shows:null,loading:!1},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_SHOWS_INFO_START":return Object(E.a)({},e,{loading:!0});case"FETCH_SHOWS_SUCCESS":return Object(E.a)({},e,{loading:!1,shows:t.shows});case"FETCH_SHOWS_INFO_FAILED":return Object(E.a)({},e,{loading:!1});case"FETCH_POSTERS_SUCCESS":return Object(E.a)({},e,{shows:t.showsWithPoster,loading:!1});case"SORT_SHOWS":return Object(E.a)({},e,{shows:t.shows});default:return e}},w=a(22),C={category:"trending",ratings:"75-100",status:"returning series",years:2019},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SORTING_FILTERS":return Object(E.a)({},e,Object(w.a)({},t.name,t.value));default:return e}},N={query:"",searchShows:null,searching:!1},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SEARCH_QUERY":return Object(E.a)({},e,{query:t.query});case"SEARCH_SHOWS_START":return Object(E.a)({},e,{searching:!0});case"SEARCH_SHOWS_SUCCESS":return Object(E.a)({},e,{searching:!1,searchShows:t.result});case"SEARCH_SHOWS_FAILED":return Object(E.a)({},e,{searching:!1});default:return e}},F=Object(_.c)({errors:S,pagination:b,shows:T,sorting:O,search:H}),k=[d.a],P=Object(_.e)(F,{},Object(_.d)(_.a.apply(void 0,k),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),R=function(){return r.a.createElement("h1",null,"TV shows")},j=function(e){return r.a.createElement("div",{className:"Container"},e.children)},I="292dfb087089a0d1e06fb7645766b94b",A="https://api.themoviedb.org/3/tv/",U="https://image.tmdb.org/t/p/",D="original",W={method:"GET",headers:new Headers({"Content-Type":"application/json","trakt-api-key":"a158772b33a2b5a08074d228e73c04e1e0967525fea9db31504a8df87902623a","trakt-api-version":"2"})},L=function(e){return{type:"SET_SEARCH_QUERY",query:e}},x=function(){return{type:"SEARCH_SHOWS_START"}},G=function(e){return{type:"SEARCH_SHOWS_SUCCESS",result:e}},q=function(e){return r.a.createElement("thead",null,r.a.createElement("tr",{className:"Table__tr"},r.a.createElement("th",{className:"Table__th"},"Number"),r.a.createElement("th",{className:"Table__th"},"Poster"),r.a.createElement("th",{className:"Table__th"},"Title"),r.a.createElement("th",{className:"Table__th"},"Year")))},M=function(e){return r.a.createElement("tr",{className:"Table__tr"},r.a.createElement("td",{className:"Table__td"},e.number),r.a.createElement("td",{className:"Table__td"},r.a.createElement("img",{src:e.show.poster?e.show.poster:"https://st.kp.yandex.net/images/movies/poster_none.png",alt:e.show.title,width:"200",height:"200"})),r.a.createElement("td",{className:"Table__td"},e.show.title),r.a.createElement("td",{className:"Table__td"},e.show.year))},Q=function(e){return r.a.createElement(r.a.Fragment,null,e.shows.map(function(e,t){return r.a.createElement(M,{key:t,number:t+1,show:e})}))},Y=function(){return r.a.createElement("div",{className:"Spinner"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))},B=function(e){return r.a.createElement("form",{className:"SearchField",onSubmit:e.onSubmitHandler},r.a.createElement("input",{className:"SearchField__input",type:"search",id:"search-input",placeholder:"Search show",value:e.value,onChange:e.onChangeHandler}),r.a.createElement("label",{htmlFor:"search-input"},r.a.createElement("span",{className:"visually-hidden"},"Search")))},X=Object(p.d)(function(e){var t=e.search,a=t.searching,n=t.searchShows,l=r.a.createElement(r.a.Fragment,null,r.a.createElement("table",{className:"Table"},r.a.createElement(q,null),r.a.createElement("tbody",null,r.a.createElement(Q,{shows:n}))));return(a||null===n)&&(l=r.a.createElement(Y,null)),""===e.search.query&&(l=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"'Search something...'"))),r.a.createElement("div",null,r.a.createElement(B,{onChangeHandler:e.onSearchInputChangeHandler,onSubmitHandler:e.onSubmitSearchHandler,value:e.value}),l)}),V=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={search:""},a.onSubmitSearchHandler=function(e){e.preventDefault();var t=a.state.search;a.props.setSearchQuery(t),a.props.history.push("/search?query=".concat(t)),a.setState({search:""})},a.onSearchInputChangeHandler=function(e){e.preventDefault(),a.setState({search:e.target.value})},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.location.search.split("=")[1];e||(e=this.props.search.query),this.props.setSearchQuery(e),this.props.searchShows(e)}},{key:"componentWillReceiveProps",value:function(e){e.search.query!==this.props.search.query&&this.props.searchShows(e.search.query)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.c,{to:"/",className:"back-button"},"Back"),r.a.createElement(X,{search:this.props.search,loading:this.props.loading,onSubmitSearchHandler:this.onSubmitSearchHandler,onSearchInputChangeHandler:this.onSearchInputChangeHandler,value:this.state.search}))}}]),t}(n.Component),J=Object(g.b)(function(e){return{search:e.search,loading:e.shows}},{searchShows:function(e){return function(t){t(x),fetch("".concat("https://api.trakt.tv/search/show?query=").concat(e),W).then(function(e){return e.json()}).then(function(e){var a;e=e.map(function(e){return e.show}),t(G(e)),t((a=e,function(e){var t=a.map(function(e){var t="".concat(A).concat(e.ids.tmdb,"/images?api_key=").concat(I);return fetch(t).then(function(e){return e.json()})});Promise.all(t).then(function(t){var n=a.map(function(e,a){var n=t[a].posters[0].file_path,r="".concat(U).concat(D,"/").concat(n);return e.poster=r,e});e(G(n))}).catch(function(t){e({type:"SEARCH_SHOWS_FAILED"}),e({type:"GET_ERRORS",errors:"Can not get posters from TMDB api"})})}))}).catch(function(e){t({type:"SEARCH_SHOWS_FAILED"}),t({type:"GET_ERRORS",errors:"Can not find anything"})})}},setSearchQuery:L})(V),$=a(26),z=a(11),K=a.n(z),Z=function(e){return r.a.createElement("li",{className:"Pagination__item"},r.a.createElement(m.b,{className:K()("Pagination__link",{"Pagination__link--active":e.page===e.currentPage}),to:1!==e.page?"/?page="+e.page:"/",onClick:function(){return e.onClick(e.page)}},e.page))},ee=function(e){var t,a=e.pagination,n=a.amountOfPages,l=a.page,s=a.amountOfPaginationLinks;l<3&&(t=l+s),l>n-2&&(t=n+1),l>=3&&l<=n-2&&(t=l+3),t>n&&(t=n+1);var c=r.a.createElement("ul",{className:"Pagination"},r.a.createElement("li",null,r.a.createElement("form",{className:"Filters"},r.a.createElement("ul",{className:"Filters__list",style:{margin:"0",marginRight:"20px"}},r.a.createElement("li",{className:"Filters__item",style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement("label",{htmlFor:"limit",style:{width:"200px",marginRight:"10px"}},"Shows per page"),r.a.createElement("select",{style:{margin:"0"},onChange:e.onChangeNadler,className:"Filters__select",id:"limit",name:"limit",value:e.value},r.a.createElement("option",{value:"5"},"5"),r.a.createElement("option",{value:"10"},"10"),r.a.createElement("option",{value:"20"},"20")))))),n>1?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("li",{className:"Pagination__item"},r.a.createElement(m.b,{className:K()("Pagination__link  Pagination__link--nav  Pagination__link--start",{"Pagination__link--disabled":1===l}),to:"/?page=1",onClick:function(){return e.onClickHandler(1)}},r.a.createElement("span",{className:"visually-hidden"},"To the beginning"))),r.a.createElement("li",{className:"Pagination__item"},r.a.createElement(m.b,{className:K()("Pagination__link  Pagination__link--nav  Pagination__link--previous",{"Pagination__link--disabled":1===l}),to:"/?page="+(l-1),onClick:function(){return e.onClickHandler(l-1)}},r.a.createElement("span",{className:"visually-hidden"}," Previous page"))),new Array(s).fill(0).map(function(a){return--t>0?r.a.createElement(Z,{key:t,page:t,currentPage:l,onClick:e.onClickHandler}):""}).reverse(),r.a.createElement("li",{className:"Pagination__item"},r.a.createElement(m.b,{className:K()("Pagination__link  Pagination__link--nav  Pagination__link--next",{"Pagination__link--disabled":l===n}),to:"/?page="+(l+1),onClick:function(){return e.onClickHandler(l+1)}},r.a.createElement("span",{className:"visually-hidden"}," Next page"))),r.a.createElement("li",{className:"Pagination__item"},r.a.createElement(m.b,{className:K()("Pagination__link  Pagination__link--nav  Pagination__link--end",{"Pagination__link--disabled":l===n}),to:"/?page="+n,onClick:function(){return e.onClickHandler(n)}},r.a.createElement("span",{className:"visually-hidden"},"To the end")))," "):"");return r.a.createElement(r.a.Fragment,null,c)},te=function(e){var t=(new Date).getFullYear()+1;return r.a.createElement("form",{className:"Filters"},r.a.createElement("ul",{className:"Filters__list"},r.a.createElement("li",{className:"Filters__item"},r.a.createElement("label",{htmlFor:"category"},"Category"),r.a.createElement("select",{className:"Filters__select",id:"category",name:"category",onChange:e.onFilterChangeHadnler,value:e.values.category},r.a.createElement("option",{value:"trending"},"trending"),r.a.createElement("option",{value:"popular"},"popular"),r.a.createElement("option",{value:"anticipated"},"anticipated"))),r.a.createElement("li",{className:"Filters__item"},r.a.createElement("label",{htmlFor:"ratings"},"Ratings"),r.a.createElement("select",{className:"Filters__select",id:"ratings",name:"ratings",onChange:e.onFilterChangeHadnler,value:e.values.ratings},r.a.createElement("option",{value:"75-100"},"7.5 - 10"),r.a.createElement("option",{value:"50-74"},"5- 7.4"),r.a.createElement("option",{value:"0-50"},"Less than 5"))),r.a.createElement("li",{className:"Filters__item"},r.a.createElement("label",{htmlFor:"years"},"Year"),r.a.createElement("select",{className:"Filters__select",id:"years",name:"years",onChange:e.onFilterChangeHadnler,value:e.values.years},new Array(10).fill(0).map(function(e,a){return e=--t,r.a.createElement("option",{key:a,value:e},e)}))),r.a.createElement("li",{className:"Filters__item"},r.a.createElement("label",{htmlFor:"status"},"Status"),r.a.createElement("select",{className:"Filters__select",id:"status",name:"status",onChange:e.onFilterChangeHadnler,value:e.values.status},r.a.createElement("option",{value:"returning series"},"returning series"),r.a.createElement("option",{value:"ended"},"ended")))))},ae=function(e){return r.a.createElement("thead",null,r.a.createElement("tr",{className:"Table__tr"},r.a.createElement("th",{className:"Table__th  Table__th--number"},"Number"),r.a.createElement("th",{className:"Table__th  Table__th--poster"},"Poster"),r.a.createElement("th",{className:"Table__th  Table__th--title"},"Title"),r.a.createElement("th",{className:"Table__th  Table__th--description"},"Description"),r.a.createElement("th",{className:"Table__th"},"episodes"),r.a.createElement("th",{className:"Table__th"},"Rating"),r.a.createElement("th",{className:"Table__th"},"Year"),r.a.createElement("th",{className:"Table__th  Table__th--genres"},"Genres"),r.a.createElement("th",{className:"Table__th Table__th--status"},"Status")))},ne=function(e){var t=e.show.overview?e.show.overview.length>=100?e.show.overview.slice(0,100)+"...":e.show.overview:"There is no description for this show";return r.a.createElement("tr",{className:"Table__tr"},r.a.createElement("td",{className:"Table__td"},e.number),r.a.createElement("td",{className:"Table__td"},r.a.createElement("img",{src:e.show.poster?e.show.poster:"https://st.kp.yandex.net/images/movies/poster_none.png",alt:e.show.title,width:"200",height:"200"})),r.a.createElement("td",{className:"Table__td"},e.show.title),r.a.createElement("td",{className:"Table__td  Table__td--description"},t),r.a.createElement("td",{className:"Table__td  Table__td--episodes"},e.show.aired_episodes),r.a.createElement("td",{className:"Table__td"},0===e.show.rating?"not rated yet":e.show.rating?e.show.rating.toFixed(2):""),r.a.createElement("td",{className:"Table__td"},e.show.year),r.a.createElement("td",{className:"Table__td"},e.show.genres?e.show.genres.join(", "):""),r.a.createElement("td",{className:"Table__td"},e.show.status))},re=function(e){return r.a.createElement(r.a.Fragment,null,e.shows.map(function(e,t){return r.a.createElement(ne,{key:t,number:t+1,show:e})}))},le=function(e){return r.a.createElement("table",{className:"Table"},r.a.createElement(ae,null),r.a.createElement("tbody",null,r.a.createElement(re,{shows:e.shows})))},se=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={search:""},a.onFilterChangeHandler=function(e){e.preventDefault();var t=e.target,n=t.name,r=t.value;a.props.setCurrentPage(1),a.props.setSortingFilters(n,encodeURIComponent(r))},a.onPaginationSelectChangeHandler=function(e){e.preventDefault();var t=e.target.value;a.setState({isUpdated:!0}),a.props.setCurrentLimit(t)},a.onSearchInputChangeHandler=function(e){e.preventDefault(),a.setState({search:e.target.value})},a.onSubmitSearchHandler=function(e){var t=a.state.search;e.preventDefault(),a.props.setSearchQuery(t),a.props.history.push("/search?query=".concat(t)),a.setState({search:""})},a.onClickHandler=function(e){a.props.setCurrentPage(e),a.setState({isUpdated:!0})},a}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.pagination,t=e.page,a=e.itemsPerPage,n=this.props.sorting,r=n.category,l=Object($.a)(n,["category"]),s=this.props.location.search.split("&");if(console.log(s),1!==s.length){var c=!0,o=!1,i=void 0;try{for(var u,h=s[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){var m=u.value.replace("?","").split("=");"page"===m[0]?(this.props.setCurrentPage(m[1]),t=encodeURIComponent(m[1])):"limit"===m[0]?(this.props.setCurrentLimit(m[1]),a=encodeURIComponent(m[1])):"category"===m[0]?(r=encodeURIComponent(m[1]),this.props.setSortingFilters(m[0],r)):(this.props.setSortingFilters(m[0],decodeURIComponent(m[1])),l[m[0]]=decodeURIComponent(m[1]))}}catch(p){o=!0,i=p}finally{try{c||null==h.return||h.return()}finally{if(o)throw i}}}this.props.fetchShows(t,a,r,l)}},{key:"componentWillReceiveProps",value:function(e){var t=e.pagination,a=t.page,n=t.itemsPerPage,r=t.amountOfPages,l=e.sorting,s=l.category,c=Object($.a)(l,["category"]);if(a!==this.props.pagination.page){for(var o="",i=0,u=Object.keys(c);i<u.length;i++){var h=u[i];o+="&".concat(h,"=").concat(c[h])}this.props.history.replace("/?page=".concat(a,"&limit=").concat(n,"&category=").concat(s).concat(o)),this.props.fetchShows(a,n,s,c)}if(n!==this.props.pagination.itemsPerPage||s!==this.props.sorting.category||c.years!==this.props.sorting.years||c.ratings!==this.props.sorting.ratings||c.status!==this.props.sorting.status){for(var m="",p=0,g=Object.keys(c);p<g.length;p++){var _=g[p];m+="&".concat(_,"=").concat(c[_])}this.props.history.replace("/?page=".concat(a,"&limit=").concat(n,"&category=").concat(s).concat(m)),this.props.fetchShows(a,n,s,c)}if(r&&r<a){this.props.setCurrentPage(r);for(var d="",E=0,v=Object.keys(c);E<v.length;E++){var S=v[E];d+="&".concat(S,"=").concat(c[S])}this.props.history.replace("/?page=".concat(r,"&limit=").concat(n,"&category=").concat(s).concat(d))}}},{key:"render",value:function(){var e=this.props.shows,t=e.shows,a=e.loading,n=r.a.createElement(r.a.Fragment,null,r.a.createElement(te,{onFilterChangeHadnler:this.onFilterChangeHandler,values:this.props.sorting}),r.a.createElement("div",{className:"flex-wrapper"},r.a.createElement(B,{onChangeHandler:this.onSearchInputChangeHandler,onSubmitHandler:this.onSubmitSearchHandler,value:this.state.search}),r.a.createElement(ee,{pagination:this.props.pagination,onClickHandler:this.onClickHandler,onChangeNadler:this.onPaginationSelectChangeHandler,value:this.props.pagination.itemsPerPage})),r.a.createElement(le,{shows:t}));return(a||null===t)&&(n=r.a.createElement(Y,null)),r.a.createElement("div",null,n)}}]),t}(n.Component),ce=Object(g.b)(function(e){return{shows:e.shows,pagination:e.pagination,sorting:e.sorting}},{fetchShows:function(e,t,a,n){return function(r){r({type:"FETCH_SHOWS_INFO_START"});var l=Object.keys(n).map(function(e){return"".concat(e,"=").concat(n[e])}).join("&");l.length>0&&(l="&"+l);var s="".concat("https://api.trakt.tv/shows/").concat(a,"?extended=full&page=").concat(e,"&limit=").concat(t).concat(l);fetch(s,W).then(function(e){var t=!0,a=!1,n=void 0;try{for(var l,s=e.headers.entries()[Symbol.iterator]();!(t=(l=s.next()).done);t=!0){var c=l.value;if("x-pagination-page-count"===c[0]){var o=c[1];r({type:"GET_AMOUNT_OF_PAGES",pagesAmount:+o})}}}catch(i){a=!0,n=i}finally{try{t||null==s.return||s.return()}finally{if(a)throw n}}return e.json()}).then(function(e){"trending"!==a&&"anticipated"!==a||(e=Array.from(e).map(function(e){return e.show})),r({type:"FETCH_SHOWS_SUCCESS",shows:e}),r(function(e){return function(t){t({type:"FETCH_SHOWS_INFO_START"});var a=e.map(function(e){var t="".concat(A).concat(e.ids.tmdb,"/images?api_key=").concat(I);return fetch(t).then(function(e){return e.json()})});Promise.all(a).then(function(a){var n=e.map(function(e,t){var n=a[t].posters[0].file_path,r="".concat(U).concat(D,"/").concat(n);return e.poster=r,e});t({type:"FETCH_POSTERS_SUCCESS",showsWithPoster:n})}).catch(function(e){t({type:"FETCH_SHOWS_INFO_FAILED"}),t({type:"GET_ERRORS",errors:"Can not get posters from TMDB api"})})}}(e))}).catch(function(e){r({type:"FETCH_SHOWS_INFO_FAILED"}),r({type:"GET_ERRORS",errors:"Can not get shows from track api"})})}},sortShows:function(e){return{type:"SORT_SHOWS",shows:e}},setCurrentPage:function(e){return{type:"SET_CURRENT_PAGE",page:+e}},setCurrentLimit:function(e){return{type:"SET_CURRENT_LIMIT",limit:+e}},setSearchQuery:L,setSortingFilters:function(e,t){return{type:"SET_SORTING_FILTERS",name:e,value:t}}})(Object(p.d)(se)),oe=(a(47),function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(g.a,{store:P},r.a.createElement(m.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(j,null,r.a.createElement(R,null),r.a.createElement(p.a,{path:"/",exact:!0,component:ce}),r.a.createElement(p.a,{path:"/search",component:J})))))}}]),t}(n.Component));s.a.render(r.a.createElement(oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[33,1,2]]]);
//# sourceMappingURL=main.80cd4441.chunk.js.map